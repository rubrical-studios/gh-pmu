# Configuration Guide

gh-pmu uses a `.gh-pmu.yml` file in your repository root to configure project connections, field aliases, and triage rules.

## Quick Setup

Run the interactive setup:

```bash
gh pmu init
```

This creates `.gh-pmu.yml` with your project settings and fetches field metadata.

## Configuration Reference

### Project Settings

```yaml
project:
  name: my-project       # Display name
  owner: your-username   # GitHub user or org
  number: 1              # Project number (from URL)
```

### Repositories

List repositories that use this project board:

```yaml
repositories:
  - your-username/repo-one
  - your-username/repo-two
```

### Defaults

Default values applied when creating issues:

```yaml
defaults:
  priority: p2           # Default priority alias
  status: backlog        # Default status alias
  labels:
    - pm-tracked         # Labels added to all new issues
```

### Field Aliases

Map short aliases to actual project field values. Use aliases in commands instead of full field names:

```yaml
fields:
  priority:
    field: Priority      # Actual field name in project
    values:
      p0: P0             # alias: Actual Value
      p1: P1
      p2: P2
  status:
    field: Status
    values:
      backlog: Backlog
      ready: Ready
      in_progress: In progress
      in_review: In review
      done: Done
```

**Usage:**
```bash
# Use alias (lowercase, underscore)
gh pmu move 42 --status in_progress --priority p1

# Instead of actual values
gh pmu move 42 --status "In progress" --priority "P1"
```

### Triage Rules

Define rules for batch processing issues:

```yaml
triage:
  # Rule name
  untracked:
    # GitHub search query
    query: "is:issue is:open -label:pm-tracked"

    # Fields/labels to apply automatically
    apply:
      labels:
        - pm-tracked
      fields:
        status: backlog
        priority: p2

    # Fields to prompt for interactively
    interactive:
      status: true
      priority: false

  # Another rule example
  stale:
    query: "is:issue is:open updated:<2024-01-01"
    apply:
      labels:
        - needs-triage
```

**Usage:**
```bash
# Preview what would be affected
gh pmu triage untracked --dry-run

# Apply the rule
gh pmu triage untracked --apply
```

### Metadata (Auto-Generated)

The `metadata` section is auto-generated by `gh pmu init`. Do not edit manually:

```yaml
metadata:
  project:
    id: PVT_xxx          # Project node ID
  fields:
    - name: Status
      id: PVTSSF_xxx
      data_type: SINGLE_SELECT
      options:
        - name: Backlog
          id: abc123
```

To refresh metadata after changing project fields:

```bash
gh pmu init --refresh
```

## Complete Example

```yaml
project:
  name: my-app
  owner: myorg
  number: 5

repositories:
  - myorg/frontend
  - myorg/backend
  - myorg/docs

defaults:
  priority: p2
  status: backlog
  labels:
    - pm-tracked

fields:
  priority:
    field: Priority
    values:
      p0: P0
      p1: P1
      p2: P2
  status:
    field: Status
    values:
      backlog: Backlog
      ready: Ready
      in_progress: In progress
      in_review: In review
      done: Done
  size:
    field: Size
    values:
      xs: XS
      s: S
      m: M
      l: L
      xl: XL

triage:
  untracked:
    query: "is:issue is:open -label:pm-tracked"
    apply:
      labels:
        - pm-tracked
      fields:
        status: backlog

metadata:
  # ... auto-generated ...
```

## Tips

- **Commit `.gh-pmu.yml`** to share configuration with your team
- **Use aliases consistently** across your workflow for faster typing
- **Run `init --refresh`** after adding new project fields
- **Multiple triage rules** let you handle different scenarios (untracked, stale, needs-review)
